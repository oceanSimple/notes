
# â™¾ï¸é¡¹ç›®æ¦‚è¦
## ðŸ’«é…ç½®ä»‹ç»
- å¼€å‘è¯­è¨€ï¼šgolang
- æœåŠ¡å™¨é€‰æ‹©ï¼šè…¾è®¯äº‘æœåŠ¡å™¨ï¼Œ2æ ¸2G
- æ“ä½œç³»ç»Ÿï¼šcentos7

## ðŸ’«ç›®å½•ç»“æž„
![[Pasted image 20240518111205.png|255]]
- `dapr`ï¼šå…³äºŽdaprçš„ä¸€äº›é…ç½®æ–‡ä»¶
- `internal`ï¼š
	- globalï¼šç”±äºŽgolangä¸­æ²¡æœ‰ä¾èµ–æ³¨å…¥åŠŸèƒ½ï¼Œå› æ­¤é‡‡å–å…¨å±€å˜é‡çš„æ¨¡å¼æ¥æ‰‹åŠ¨é…ç½®æœåŠ¡ï¼Œå·²è¾¾åˆ°ä¾èµ–æ³¨å…¥çš„ç›®çš„
	- gormInitï¼šgormçš„é…ç½®å‡½æ•°
	- logï¼šæ—¥å¿—çš„é…ç½®å‡½æ•°
	- middlewareï¼šä¸­é—´ä»¶ï¼Œæœ¬é¡¹ç›®ä¸­ä¸»è¦æ˜¯jwtéªŒè¯ä¸­é—´ä»¶
	- modelï¼šä¸Žæ•°æ®åº“è¡¨ç»“æž„å¯¹åº”çš„å®žä½“ç»“æž„ä½“
	- myJwtï¼šjwtå…³äºŽç”Ÿæˆå’Œè§£æžçš„å‡½æ•°
	- rabbitmqï¼šå…³äºŽæ¶ˆæ¯äº‹ä»¶ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å‡½æ•°
	- responseï¼šæœåŠ¡å™¨è¿”å›žæ•°æ®çš„ç»Ÿä¸€æ ¼å¼
	- serviceï¼šæœåŠ¡å™¨é€šç”¨çš„æœåŠ¡è°ƒç”¨
	- toolï¼šå·¥å…·å‡½æ•°
- `logFile`ï¼šå­˜å‚¨infoæ—¥å¿—å’Œerroræ—¥å¿—çš„ç‰©ç†ç›®å½•
- `restful`ï¼šåŽç«¯æœåŠ¡
	- DddServerï¼šé‡‡ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡è¿›è¡Œçš„åŽç«¯å¼€å‘
	- textItemï¼šé‡‡ç”¨ä¼ ç»Ÿçš„mvcæ¨¡å¼è¿›è¡Œçš„åŽç«¯å¼€å‘
	- logCenterï¼šæ—¥å¿—ç»Ÿä¸€å¤„ç†æœåŠ¡ï¼ŒåŠrabbitmqçš„consumeræœåŠ¡å™¨
- `script`ï¼šæ”¾ç½®ä¸€äº›é™æ€çš„è„šæœ¬æœåŠ¡
	- sqlï¼šmysqlè„šæœ¬
- `go.mod`ï¼šgolangé¡¹ç›®çš„åŒ…é…ç½®ç®¡ç†
- `docker-compose.yml`ï¼šdockeré•œåƒéƒ¨ç½²æ–‡ä»¶ï¼Œåªè¦åŒ…å«mysqlã€zipkinã€rabbitmqçš„é•œåƒéƒ¨ç½²

# â™¾ï¸rabbitmq-åˆ†å¸ƒå¼æ—¥å¿—
## ðŸ’«è¯´æ˜Ž
åŽŸå®šè®¡åˆ’é‡‡ç”¨çš„æ˜¯ä½¿ç”¨kafkaä½œä¸ºåˆ†å¸ƒå¼æ¶ˆæ¯æœåŠ¡å™¨ï¼Œä½†ç”±äºŽæœåŠ¡å™¨åªæœ‰2Gçš„å†…å­˜ï¼Œkafkaçš„dockeréƒ¨ç½²å ç”¨å¤ªå¤šå†…å­˜ï¼Œå› æ­¤æœ¬é¡¹ç›®é€‰å–è½»é‡çº§çš„rabbitmqä½œä¸ºæ¶ˆæ¯æœåŠ¡å™¨ï¼Œæ“ä½œä¸Žkafkaç±»ä¼¼ã€‚





# â™¾ï¸apisix-ç½‘å…³æœåŠ¡
> æŸ¥çœ‹ä¸Šæ¸¸
```shell
curl "http://127.0.0.1:9180/apisix/admin/upstreams" \
-H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -X GET
```

> æŸ¥çœ‹è·¯ç”±

```shell
curl http://127.0.0.1:9180/apisix/admin/routes -H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1'
```

## è®¾ç½®ä¸Šæ¸¸
1. textItem
```shell
curl http://127.0.0.1:9180/apisix/admin/upstreams/1  \
-H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -i -X PUT -d '
{
    "type":"roundrobin",
    "nodes":{
        "111.229.78.126:8000": 1
    }
}'
```

2. ddd
```shell
curl http://127.0.0.1:9180/apisix/admin/upstreams/2  \
-H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -i -X PUT -d '
{
    "type":"roundrobin",
    "nodes":{
        "111.229.78.126:8001": 1
    }
}'
```

## è·¯ç”±è®¾ç½®
1. textItem
```shell
curl http://127.0.0.1:9180/apisix/admin/routes/1 \
-H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -X PUT -i -d '
{
    "uri": "/textItem/*",
    "upstream_id": 1
}'
```

2. ddd
```shell
curl http://127.0.0.1:9180/apisix/admin/routes/2 \
-H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -X PUT -i -d '
{
    "uri": "/ddd/*",
    "upstream_id": 2
}'
```